### 📌 **프로세스 주소 공간 (Process Address Space) 상세 분석**

운영체제에서 프로세스가 실행될 때, 메모리는 여러 영역으로 나뉘어 관리된다. 각 영역은 **고유한 역할**을 가지며, 데이터를 저장하는 방식이 다르다.

---

## 🏗 **1. 프로세스 주소 공간의 전체 구조**

**(일반적인 32-bit 시스템 기준, 리눅스 환경)**


![메모리 구조](https://github.com/user-attachments/assets/122ad214-a79c-417a-bede-7bd22ad4c1a6)

```
-----------------------------
|        스택(Stack)        |  ⬇ 함수 호출 시마다 생성되는 지역 변수 & 리턴 주소
-----------------------------
|         힙(Heap)          |  ⬆ 동적 메모리 할당 공간 (malloc, new 등)
-----------------------------
|   초기화되지 않은 데이터  |  ⬅ BSS (Block Started by Symbol)
|   (Uninitialized Data)   |
-----------------------------
|   초기화된 데이터 (Data)  |  ⬅ 전역변수 & static 변수 (초기값 있는 경우)
-----------------------------
|         코드(Code)        |  ⬅ 실행 코드 (읽기 전용)
-----------------------------
```

> ✔ **스택(Stack)** 은 아래 방향, **힙(Heap)** 은 위 방향으로 확장됨. ✔ **데이터(Data) 영역은 초기화 여부에 따라 나뉨 (BSS & 초기화된 데이터 영역).**

---

## 🏗 **2. 코드(Code) 영역**

- 프로그램 실행을 위한 **기계어 명령어(Instruction)** 가 저장됨.
- 보통 **읽기 전용(Read-Only)** 으로 설정됨 → 코드가 실수로 수정되지 않도록 보호됨.
- `.text` 섹션이라고도 불림.

📌 **예제 (C 코드)**

```c
void function() {
    printf("Hello, World!\n");
}
```

➡ `function()`이 실행되면, 이 함수의 **기계어 코드**가 **코드 영역**에 저장된다.

---

## 🏗 **3. 데이터(Data) 영역** → **초기화 여부에 따라 나뉨**

### 🔹 **(1) 초기화된 데이터 영역 (Initialized Data)**

- 초기값이 **있는** 전역 변수 & static 변수가 저장됨.
- 실행 파일의 `.data` 섹션에 포함됨.

📌 **예제 (C 코드)**

```c
int global_var = 3;  // 전역 변수 (초기값 있음)
static int static_var = 10; // static 변수 (초기값 있음)
```

➡ `global_var`, `static_var`는 **초기화된 데이터 영역**에 저장됨.

---

### 🔹 **(2) 초기화되지 않은 데이터 영역 (BSS - Block Started by Symbol)**

- 초기값이 **없는** 전역 변수 & static 변수가 저장됨.
- 실행 파일의 `.bss` 섹션에 포함됨.
- 실행될 때 **자동으로 0으로 초기화됨** (컴파일러가 0으로 채워줌).
- **BSS 영역을 사용하는 이유:**
  - 실행 파일의 크기를 줄일 수 있음.
  - 초기화되지 않은 변수를 실행 파일에 포함하지 않고, 실행 시 RAM에서 0으로 초기화함.
  - RAM과 ROM을 효율적으로 활용할 수 있도록 최적화함.

📌 **예제 (C 코드)**

```c
int uninit_global;  // 초기값 없는 전역 변수
static int uninit_static; // 초기값 없는 static 변수
```

➡ `uninit_global`, `uninit_static`는 **BSS 영역**에 저장됨.

➡ 실행 시 자동으로 `0`으로 초기화됨.

---

## 🏗 **4. 힙(Heap) 영역**

- 실행 중 **동적 메모리 할당(malloc, calloc, realloc, new 등)** 에 사용됨.
- 위쪽(높은 주소 방향)으로 확장됨.
- 프로그래머가 **직접 해제해야 함** (`free()`, `delete`).

📌 **예제 (C 코드)**

```c
int *ptr = (int *)malloc(sizeof(int) * 10);  // 동적 배열 할당
free(ptr);  // 사용이 끝나면 반드시 해제해야 함
```

➡ `ptr`이 가리키는 메모리는 **힙 영역**에서 할당됨.

➡ `free(ptr);`을 호출하지 않으면 **메모리 누수(Memory Leak)** 가 발생함.

---

## 🏗 **5. 스택(Stack) 영역**

- 함수 호출 시 **지역 변수 & 매개변수**가 저장됨.
- **아래 방향(낮은 주소 방향)으로 확장됨**
- 함수가 종료되면 자동으로 할당된 메모리가 해제됨.
- 너무 많이 사용하면 **스택 오버플로우(Stack Overflow)** 발생 가능.

📌 **예제 (C 코드)**

```c
void function() {
    int local_var = 5;  // 지역 변수 (스택에 저장)
}
```

➡ `local_var`는 **스택 영역**에 저장됨.

➡ `function()`이 종료되면 자동으로 제거됨.

---

## 🏗 **6. 리눅스에서 프로세스 주소 공간 (0\~4GB 예제)**

리눅스에서 **32-bit 시스템 기준**, 프로세스는 다음과 같이 메모리를 사용한다.

| 메모리 주소     | 설명                               |
| ---------- | -------------------------------- |
| 3GB \~ 4GB | **커널(Kernel) 전용 공간** (사용자 접근 불가) |
| 0GB \~ 3GB | **사용자(User Mode) 프로세스 공간**       |
| 높은 주소      | **스택(Stack)**                    |
| 낮은 주소      | **힙(Heap)**                      |
| 0x0804xxxx | **데이터(Data) 영역**                 |
| 0x08048000 | **코드(Code) 영역**                  |

---

## 📌 **정리**

| **영역**           | **내용**                                  |
| ---------------- | --------------------------------------- |
| **코드(Code) 영역**  | 실행 코드 (기계어 명령어) 저장, 읽기 전용               |
| **초기화된 데이터 영역**  | 초기값이 있는 전역 변수, static 변수 저장 (`.data`)   |
| **BSS 영역**       | 초기값 없는 전역 변수, static 변수 저장 (`.bss`)     |
| **힙(Heap) 영역**   | 동적 메모리 할당 공간, 위쪽으로 확장 (`malloc`, `new`) |
| **스택(Stack) 영역** | 함수 호출 시 지역 변수 저장, 아래쪽으로 확장              |

🔗 **참고 자료:** [자바 메모리 구조 정리](https://inpa.tistory.com/entry/JAVA-%E2%98%95-%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EB%B3%B4%EB%8A%94-%EC%9E%90%EB%B0%94-%EC%BD%94%EB%93%9C%EC%9D%98-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%98%81%EC%97%AD%EC%8A%A4%ED%83%9D-%ED%9E%99)

