### **인터럽트(Interrupt)란?**

CPU가 특정 기능을 수행하는 도중 **예기치 않은 상황이 발생**하면, 현재 실행 중인 작업을 즉시 중단하고 **발생한 상황을 처리**해야 한다고 CPU에게 알리는 메커니즘.

---

## **폴링(Polling) vs 인터럽트(Interrupt)**

### **폴링(Polling) - 구시대적인 이벤트 감지 방식**

- CPU가 반복적으로 특정 장치를 확인하여 이벤트 발생 여부를 체크.
- 구현이 단순하며 **우선순위를 정하기 쉬움**.
- 하지만 **이벤트가 없어도 계속 확인해야 하므로 CPU 자원이 많이 소모됨**.

### **인터럽트(Interrupt) - 현대적인 이벤트 감지 방식**

- **주변 장치**(입출력 장치, 타이머 등)에서 특정 이벤트가 발생하면 **인터럽트 신호를 CPU에 전송**.
- **CPU는 실행 중인 작업을 중단**하고, 인터럽트 핸들러를 실행하여 이벤트를 처리.
- **CPU의 지속적인 체크가 필요 없음**, 이벤트가 발생했을 때만 반응.
- 하지만 **인터럽트 우선순위 및 다중 인터럽트 처리 순서를 결정해야 함**.

---

## **인터럽트 동작 과정**

1. **인터럽트 발생 (Interrupt Request, IRQ)**
    - 외부 입력(버튼 눌림, 센서 값 변화) 또는 내부 이벤트(타이머 만료, UART 데이터 수신)로 인해 인터럽트 발생.
    - **인터럽트 컨트롤러(Interrupt Controller)**가 이를 감지하고 CPU에 알림.
2. **현재 실행 중인 명령 저장 (Context Saving)**
    - CPU는 현재 수행 중이던 **명령의 상태(PC, 레지스터 값)를 스택(Stack)에 저장**.
    - 이후 원래 작업으로 복귀할 수 있도록 설정.
3. **인터럽트 벡터 테이블(IVT, Interrupt Vector Table) 조회**
    - CPU는 **인터럽트 벡터 테이블**을 참조하여 해당 인터럽트의 처리 코드(인터럽트 핸들러)를 찾음.
4. **인터럽트 핸들러(ISR, Interrupt Service Routine) 실행**
    - 인터럽트 벡터 테이블에서 찾은 ISR을 실행하여 특정 이벤트를 처리.
    - 예: 버튼이 눌리면 LED를 켜는 코드 실행.
5. **인터럽트 종료 및 원래 작업 복귀 (Context Restoring)**
    - ISR 실행이 끝나면 **스택에서 이전 상태를 복원**하여 원래 실행 중이던 프로그램으로 돌아감.

---

## **인터럽트 벡터 (Interrupt Vector)**

- 인터럽트 요청이 발생했을 때, CPU는 **인터럽트 소스가 무엇인지, 핸들러(ISR)가 어디에 있는지 확인**해야 함.
- **인터럽트 벡터**는 **인터럽트 핸들러의 시작 주소를 저장하는 테이블**.
- 여러 개의 인터럽트 벡터를 모아 둔 **인터럽트 벡터 테이블(Interrupt Vector Table, IVT)이** 메모리에 저장됨.

---

## **인터럽트 핸들러 (ISR, Interrupt Service Routine)**

- **인터럽트가 발생하면 실행할 코드**.
- **짧고 빠르게 실행**되어야 하며, 시스템 성능을 위해 최소한의 코드만 포함해야 함.
- 반드시 **종료(return)**가 필요함 → 인터럽트 처리가 끝나면 원래 실행하던 프로그램으로 복귀해야 함.

---

## **인터럽트의 종류**

### **1. 하드웨어 인터럽트 (Hardware Interrupt)**

- **하드웨어 장치(키보드, 마우스, 타이머, 네트워크)** 에서 발생하는 인터럽트.
- **외부 장치가 CPU에 신호를 보내 특정 작업을 요청**.
- **비동기적(Asynchronous**으로 발생 → CPU가 예상치 못한 순간에도 발생 가능.

### **하드웨어 인터럽트의 예시**

- **타이머 인터럽트** → Context Switching (프로세스 스케줄링) 시 사용.
- **I/O 인터럽트** → 입출력 장치(디스크, 네트워크 등)가 작업 완료 시 발생.
- **전원 이상 인터럽트** → 전원 공급이 갑작스럽게 중단될 때.

---

### **2. 소프트웨어 인터럽트 (Software Interrupt)**

- **소프트웨어적으로 발생하는 인터럽트**.
- 프로그램이 실행되는 동안 CPU에게 특정 작업을 요청하거나 오류가 발생하면 발생.

### **소프트웨어 인터럽트의 예시**

### **(1) Trap (Exception) - 예외 처리**

- **프로그램 실행 중 예외(Exception)가 발생하여 CPU가 직접 처리**.
- 예: **0으로 나누기(Divide by Zero), 페이지 폴트(Page Fault), 보호 오류(Segmentation Fault)**

### **(2) SVC 인터럽트 (Supervisor Call Interrupt) - 운영체제 호출**

- **운영체제를 호출하여 커널 모드로 전환할 때 발생**.
- **시스템 콜(System Call)**을 이용하여 커널의 함수를 호출할 수 있음.

---

## **시스템 콜 (System Call)과 인터럽트**

운영체제에서 **사용자 프로그램이 운영체제의 기능(파일 열기, 메모리 할당, 프로세스 생성 등)을 요청할 때 사용**하는 인터럽트 메커니즘.

### **시스템 콜(System Call) 동작 과정**

1. **사용자 프로그램이 시스템 콜을 실행** (예: `open()`, `read()`, `write()`)
2. CPU는 **소프트웨어 인터럽트(SVC)를 발생시켜 커널 모드로 전환**.
3. 운영체제 커널은 **해당 시스템 콜을 처리**.
4. 작업이 끝나면 **사용자 모드로 복귀**하여 프로그램 실행을 계속함.

### **시스템 콜 예시 (Linux)**

```c
c
복사편집
#include <stdio.h>
#include <unistd.h>

int main() {
    write(1, "Hello, World!\n", 14);  // 시스템 콜을 사용하여 출력
    return 0;
}

```

- `write()` 함수는 **시스템 콜을 통해 커널의 `sys_write` 함수를 호출**.
- 내부적으로 **소프트웨어 인터럽트(INT 0x80, syscall)를 발생시켜 커널 모드로 전환**.

---

## **결론**

- **인터럽트는 CPU가 예상치 못한 이벤트를 처리하는 메커니즘**.
- **폴링(Polling)보다 CPU 리소스를 절약할 수 있어 효율적**.
- **인터럽트는 하드웨어 인터럽트(외부 장치)와 소프트웨어 인터럽트(예외, 시스템 콜)로 나뉨**.
- **인터럽트 핸들러(ISR)는 인터럽트가 발생했을 때 실행되는 코드**.
- **시스템 콜(System Call)은 운영체제 기능을 요청하는 소프트웨어 인터럽트**.
- **인터럽트 벡터 테이블(IVT)을 통해 적절한 핸들러가 실행됨**.

인터럽트를 잘 활용하면 **CPU가 멀티태스킹을 효과적으로 수행**할 수 있습니다! 🚀
